fpath+=$HOME/.zsh/completion

# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

# Load secrets (interactive shells only)
if [[ -f ~/.secrets_rc ]]; then
  source ~/.secrets_rc
fi

# History Settings
HISTFILE=$HOME/.zsh_history
HISTSIZE=1000000
SAVEHIST=1000000

setopt APPEND_HISTORY             # Don't overwrite, just append
setopt INC_APPEND_HISTORY         # Write after each command
setopt SHARE_HISTORY              # Share history across sessions
setopt HIST_EXPIRE_DUPS_FIRST     # Prefer deleting dupes
setopt HIST_IGNORE_ALL_DUPS       # No duplicate entries
setopt HIST_FIND_NO_DUPS          # Skip dupes in reverse search
setopt HIST_SAVE_NO_DUPS          # skip saving duplicate entries at all
setopt HIST_IGNORE_SPACE          # ignore lines starting with space
setopt EXTENDED_HISTORY           # save timestamps + duration

autoload -U compinit
compinit -i

bindkey -e
# Opt arrow keys should move words
bindkey "^[[1;5C" forward-word
bindkey "^[[1;5D" backward-word

# Load Catppuccin theme for zsh-syntax-highlighting
source ~/.zsh/catppuccin_mocha-zsh-syntax-highlighting.zsh

# Customize zsh-syntax-highlighting
ZSH_HIGHLIGHT_STYLES[cursor]='bold'

# Aliases
alias vim="nvim"
alias v="nvim"
alias tree="eza --tree"
alias ls="eza"
alias ll="eza -alh"
alias cat="bat"
alias gr="gt"
alias startDocker="open /Applications/Docker.app"
# makes a new scratch buffer
alias scratch="nvim -c 'set buftype=nofile' -c 'enew'"

vscratch() {
    tmux split-window -h "nvim -c 'set buftype=nofile' -c 'enew' -c 'autocmd BufLeave <buffer> :q!'"
}

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

source ~/powerlevel10k/powerlevel10k.zsh-theme

# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

source /opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

# Uncomment to profile shell startup, then run `zprof` after shell starts:
# zmodload zsh/zprof

flush_history() {
  fc -RI   # Reread history file, then insert into history list
}
